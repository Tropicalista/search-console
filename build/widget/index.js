(()=>{"use strict";var e={n:t=>{var r=t&&t.__esModule?()=>t.default:()=>t;return e.d(r,{a:r}),r},d:(t,r)=>{for(var o in r)e.o(r,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:r[o]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const t=window.wp.element,r=window.wp.i18n,o=window.wp.components,s=window.wp.url,n=window.React;function a(e){let{onLoad:t,onError:r,...o}=e;const[s,a]=function(e){let{chartVersion:t="current",chartPackages:r=["corechart","controls"],chartLanguage:o="en",mapsApiKey:s}=e;const[a,i]=(0,n.useState)(null),[l,c]=(0,n.useState)(!1);var d,p,h;return d="https://www.gstatic.com/charts/loader.js",p=()=>{const e=null===window||void 0===window?void 0:window.google;e&&(e.charts.load(t,{packages:r,language:o,mapsApiKey:s}),e.charts.setOnLoadCallback((()=>{i(e)})))},h=()=>{c(!0)},(0,n.useEffect)((()=>{if(!document)return;const e=document.querySelector('script[src="'.concat(d,'"]'));if(null==e?void 0:e.dataset.loaded)return void(null==p||p());const t=e||document.createElement("script");e||(t.src=d);const r=()=>{t.dataset.loaded="1",null==p||p()};return t.addEventListener("load",r),h&&t.addEventListener("error",h),e||document.head.append(t),()=>{t.removeEventListener("load",r),h&&t.removeEventListener("error",h)}}),[]),[a,l]}(o);return(0,n.useEffect)((()=>{s&&t&&t(s)}),[s]),(0,n.useEffect)((()=>{a&&r&&r()}),[a]),null}const i={legend_toggle:!1,options:{},legendToggle:!1,getChartWrapper:()=>{},spreadSheetQueryParameters:{headers:1,gid:1},rootProps:{},chartWrapperParams:{}};let l=0;const c=["#3366CC","#DC3912","#FF9900","#109618","#990099","#3B3EAC","#0099C6","#DD4477","#66AA00","#B82E2E","#316395","#994499","#22AA99","#AAAA11","#6633CC","#E67300","#8B0707","#329262","#5574A6","#3B3EAC"],{Provider:d,Consumer:p}=n.createContext(i),h=e=>{let{children:t,value:r}=e;return n.createElement(d,{value:r},t)},u=e=>{let{render:t}=e;return n.createElement(p,null,(e=>t(e)))};class g extends n.Component{componentDidMount(){this.draw(this.props),window.addEventListener("resize",this.onResize),(this.props.legend_toggle||this.props.legendToggle)&&this.listenToLegendToggle()}componentWillUnmount(){const{google:e,googleChartWrapper:t}=this.props;window.removeEventListener("resize",this.onResize),e.visualization.events.removeAllListeners(t),"Timeline"===t.getChartType()&&t.getChart()&&t.getChart().clearChart()}componentDidUpdate(){this.draw(this.props)}render(){return null}constructor(...e){super(...e),this.state={hiddenColumns:[]},this.listenToLegendToggle=()=>{const{google:e,googleChartWrapper:t}=this.props;e.visualization.events.addListener(t,"select",(()=>{const e=t.getChart().getSelection(),r=t.getDataTable();if(0===e.length||e[0].row||!r)return;const o=e[0].column,s=this.getColumnID(r,o);this.state.hiddenColumns.includes(s)?this.setState((e=>({...e,hiddenColumns:[...e.hiddenColumns.filter((e=>e!==s))]}))):this.setState((e=>({...e,hiddenColumns:[...e.hiddenColumns,s]})))}))},this.applyFormatters=(e,t)=>{const{google:r}=this.props;for(let o of t)switch(o.type){case"ArrowFormat":new r.visualization.ArrowFormat(o.options).format(e,o.column);break;case"BarFormat":new r.visualization.BarFormat(o.options).format(e,o.column);break;case"ColorFormat":{const t=new r.visualization.ColorFormat(o.options),{ranges:s}=o;for(let e of s)t.addRange(...e);t.format(e,o.column);break}case"DateFormat":new r.visualization.DateFormat(o.options).format(e,o.column);break;case"NumberFormat":new r.visualization.NumberFormat(o.options).format(e,o.column);break;case"PatternFormat":new r.visualization.PatternFormat(o.options).format(e,o.column)}},this.getColumnID=(e,t)=>e.getColumnId(t)||e.getColumnLabel(t),this.draw=async e=>{let{data:t,diffdata:r,rows:o,columns:s,options:n,legend_toggle:a,legendToggle:i,chartType:l,formatters:c,spreadSheetUrl:d,spreadSheetQueryParameters:p}=e;const{google:h,googleChartWrapper:u}=this.props;let g,m=null;if(r){const e=h.visualization.arrayToDataTable(r.old),t=h.visualization.arrayToDataTable(r.new);m=h.visualization[l].prototype.computeDiff(e,t)}g=null!==t?Array.isArray(t)?h.visualization.arrayToDataTable(t):new h.visualization.DataTable(t):o&&s?h.visualization.arrayToDataTable([s,...o]):d?await async function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return new Promise(((o,s)=>{const n="".concat(r.headers?"headers=".concat(r.headers):"headers=0"),a="".concat(r.query?"&tq=".concat(encodeURIComponent(r.query)):""),i="".concat(r.gid?"&gid=".concat(r.gid):""),l="".concat(r.sheet?"&sheet=".concat(r.sheet):""),c="".concat(r.access_token?"&access_token=".concat(r.access_token):""),d="".concat(n).concat(i).concat(l).concat(a).concat(c),p="".concat(t,"/gviz/tq?").concat(d);new e.visualization.Query(p).send((e=>{e.isError()?s("Error in query:  ".concat(e.getMessage()," ").concat(e.getDetailedMessage())):o(e.getDataTable())}))}))}(h,d,p):h.visualization.arrayToDataTable([]);const C=g.getNumberOfColumns();for(let e=0;e<C;e+=1){const t=this.getColumnID(g,e);if(this.state.hiddenColumns.includes(t)){const t=g.getColumnLabel(e),r=g.getColumnId(e),o=g.getColumnType(e);g.removeColumn(e),g.addColumn({label:t,id:r,type:o})}}const y=u.getChart();"Timeline"===u.getChartType()&&y&&y.clearChart(),u.setChartType(l),u.setOptions(n||{}),u.setDataTable(g),u.draw(),null!==this.props.googleChartDashboard&&this.props.googleChartDashboard.draw(g),m&&(u.setDataTable(m),u.draw()),c&&(this.applyFormatters(g,c),u.setDataTable(g),u.draw()),!0!==i&&!0!==a||this.grayOutHiddenColumns({options:n})},this.grayOutHiddenColumns=e=>{let{options:t}=e;const{googleChartWrapper:r}=this.props,o=r.getDataTable();if(!o)return;const s=o.getNumberOfColumns();if(!1==this.state.hiddenColumns.length>0)return;const n=Array.from({length:s-1}).map(((e,r)=>{const s=this.getColumnID(o,r+1);return this.state.hiddenColumns.includes(s)?"#CCCCCC":t&&t.colors?t.colors[r]:c[r]}));r.setOptions({...t,colors:n}),r.draw()},this.onResize=()=>{const{googleChartWrapper:e}=this.props;e.draw()}}}class m extends n.Component{componentDidMount(){}componentWillUnmount(){}shouldComponentUpdate(){return!1}render(){const{google:e,googleChartWrapper:t,googleChartDashboard:r}=this.props;return n.createElement(u,{render:o=>n.createElement(g,Object.assign({},o,{google:e,googleChartWrapper:t,googleChartDashboard:r}))})}}class C extends n.Component{shouldComponentUpdate(){return!1}listenToEvents(e){let{chartEvents:t,google:r,googleChartWrapper:o}=e;if(t){r.visualization.events.removeAllListeners(o);for(let e of t){var s=this;const{eventName:t,callback:n}=e;r.visualization.events.addListener(o,t,(function(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];n({chartWrapper:o,props:s.props,google:r,eventArgs:t})}))}}}render(){const{google:e,googleChartWrapper:t}=this.props;return n.createElement(u,{render:r=>(this.listenToEvents({chartEvents:r.chartEvents||null,google:e,googleChartWrapper:t}),null)})}}let y=0;class v extends n.Component{componentDidMount(){const{options:e,google:t,chartType:r,chartWrapperParams:o,toolbarItems:s,getChartEditor:n,getChartWrapper:a}=this.props,i={chartType:r,options:e,containerId:this.getGraphID(),...o},l=new t.visualization.ChartWrapper(i);l.setOptions(e||{}),a&&a(l,t);const c=new t.visualization.Dashboard(this.dashboard_ref),d=this.addControls(l,c);s&&t.visualization.drawToolbar(this.toolbar_ref.current,s);let p=null;n&&(p=new t.visualization.ChartEditor,n({chartEditor:p,chartWrapper:l,google:t})),this.setState({googleChartEditor:p,googleChartControls:d,googleChartDashboard:c,googleChartWrapper:l,isReady:!0})}componentDidUpdate(){if(!this.state.googleChartWrapper)return;if(!this.state.googleChartDashboard)return;if(!this.state.googleChartControls)return;const{controls:e}=this.props;if(e)for(let t=0;t<e.length;t+=1){const{controlType:r,options:o,controlWrapperParams:s}=e[t];s&&"state"in s&&this.state.googleChartControls[t].control.setState(s.state),this.state.googleChartControls[t].control.setOptions(o),this.state.googleChartControls[t].control.setControlType(r)}}shouldComponentUpdate(e,t){return this.state.isReady!==t.isReady||e.controls!==this.props.controls}render(){const{width:e,height:t,options:r,style:o}=this.props,s={height:t||r&&r.height,width:e||r&&r.width,...o};return this.props.render?n.createElement("div",{ref:this.dashboard_ref,style:s},n.createElement("div",{ref:this.toolbar_ref,id:"toolbar"}),this.props.render({renderChart:this.renderChart,renderControl:this.renderControl,renderToolbar:this.renderToolBar})):n.createElement("div",{ref:this.dashboard_ref,style:s},this.renderControl((e=>{let{controlProp:t}=e;return"bottom"!==t.controlPosition})),this.renderChart(),this.renderControl((e=>{let{controlProp:t}=e;return"bottom"===t.controlPosition})),this.renderToolBar())}constructor(...e){var t;super(),t=this,this.state={googleChartWrapper:null,googleChartDashboard:null,googleChartControls:null,googleChartEditor:null,isReady:!1},this.graphID=null,this.dashboard_ref=n.createRef(),this.toolbar_ref=n.createRef(),this.getGraphID=()=>{const{graphID:e,graph_id:t}=this.props;let r;return e||t?r=e&&!t?e:t&&!e?t:e:this.graphID?r=this.graphID:(l+=1,r="reactgooglegraph-".concat(l)),this.graphID=r,this.graphID},this.getControlID=(e,t)=>{let r;return y+=1,r=void 0===e?"googlechart-control-".concat(t,"-").concat(y):e,r},this.addControls=(e,t)=>{const{google:r,controls:o}=this.props,s=o?o.map(((e,t)=>{const{controlID:o,controlType:s,options:n,controlWrapperParams:a}=e,i=this.getControlID(o,t);return{controlProp:e,control:new r.visualization.ControlWrapper({containerId:i,controlType:s,options:n,...a})}})):null;if(!s)return null;t.bind(s.map((e=>{let{control:t}=e;return t})),e);for(let t of s){const{control:o,controlProp:s}=t,{controlEvents:a=[]}=s;for(let t of a){var n=this;const{callback:s,eventName:a}=t;r.visualization.events.removeListener(o,a,s),r.visualization.events.addListener(o,a,(function(){for(var t=arguments.length,a=new Array(t),i=0;i<t;i++)a[i]=arguments[i];s({chartWrapper:e,controlWrapper:o,props:n.props,google:r,eventArgs:a})}))}}return s},this.renderChart=()=>{const{width:e,height:t,options:r,style:o,className:s,rootProps:a,google:i}=this.props,l={height:t||r&&r.height,width:e||r&&r.width,...o};return n.createElement("div",Object.assign({id:this.getGraphID(),style:l,className:s},a),this.state.isReady&&null!==this.state.googleChartWrapper?n.createElement(n.Fragment,null,n.createElement(m,{googleChartWrapper:this.state.googleChartWrapper,google:i,googleChartDashboard:this.state.googleChartDashboard}),n.createElement(C,{googleChartWrapper:this.state.googleChartWrapper,google:i})):null)},this.renderControl=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e=>!0;return t.state.isReady&&null!==t.state.googleChartControls?n.createElement(n.Fragment,null,t.state.googleChartControls.filter((t=>{let{controlProp:r,control:o}=t;return e({control:o,controlProp:r})})).map((e=>{let{control:t,controlProp:r}=e;return n.createElement("div",{key:t.getContainerId(),id:t.getContainerId()})}))):null},this.renderToolBar=()=>this.props.toolbarItems?n.createElement("div",{ref:this.toolbar_ref}):null}}class w extends n.Component{render(){const{chartLanguage:e,chartPackages:t,chartVersion:r,mapsApiKey:o,loader:s,errorElement:i}=this.props;return n.createElement(h,{value:this.props},"ready"===this.state.loadingStatus&&null!==this.state.google?n.createElement(v,Object.assign({},this.props,{google:this.state.google})):"errored"===this.state.loadingStatus&&i?i:s,n.createElement(a,{chartLanguage:e,chartPackages:t,chartVersion:r,mapsApiKey:o,onLoad:this.onLoad,onError:this.onError}))}componentDidMount(){this._isMounted=!0}componentWillUnmount(){this._isMounted=!1}isFullyLoaded(e){const{controls:t,toolbarItems:r,getChartEditor:o}=this.props;return e&&e.visualization&&e.visualization.ChartWrapper&&e.visualization.Dashboard&&(!t||e.visualization.ChartWrapper)&&(!o||e.visualization.ChartEditor)&&(!r||e.visualization.drawToolbar)}constructor(...e){super(...e),this._isMounted=!1,this.state={loadingStatus:"loading",google:null},this.onLoad=e=>{if(this.props.onLoad&&this.props.onLoad(e),this.isFullyLoaded(e))this.onSuccess(e);else{const e=setInterval((()=>{const t=window.google;this._isMounted?t&&this.isFullyLoaded(t)&&(clearInterval(e),this.onSuccess(t)):clearInterval(e)}),1e3)}},this.onSuccess=e=>{this.setState({loadingStatus:"ready",google:e})},this.onError=()=>{this.setState({loadingStatus:"errored"})}}}var f;w.defaultProps=i,function(e){e.annotation="annotation",e.annotationText="annotationText",e.certainty="certainty",e.emphasis="emphasis",e.interval="interval",e.scope="scope",e.style="style",e.tooltip="tooltip",e.domain="domain"}(f||(f={}));const D=window.wp.date,E=window.wp.coreData,T=window.wp.data,S=window.wp.notices,b=window.ReactJSXRuntime,_=(0,t.createContext)(),I=function(e){const o={customDate:!1,type:"web",startDate:(0,D.dateI18n)("Y-m-d",(new Date).setDate((new Date).getDate()-29)),endDate:(0,D.dateI18n)("Y-m-d",(new Date).setDate((new Date).getDate()-1)),dimensions:["QUERY"],fields:"rows",dimensionFilterGroups:[]},[s,n]=(0,t.useState)(o),[a,i]=(0,t.useState)(!1),[l,c]=(0,E.useEntityProp)("root","site","search_console"),{saveEditedEntityRecord:d}=(0,T.useDispatch)(E.store),{createNotice:p}=(0,T.useDispatch)(S.store),{isSaving:h,hasEdits:u}=(0,T.useSelect)((e=>({isSaving:e(E.store).isSavingEntityRecord("root","site"),hasEdits:e(E.store).hasEditsForEntityRecord("root","site",void 0,"search_console")})),[]);return(0,b.jsx)(_.Provider,{value:{query:s,updateQuery:(e,t)=>{n({...s,[e]:t})},settings:l,updateSetting:(e,t)=>{c({...l,[e]:t})},setSettings:c,saveSettings:async()=>d("root","site").then((()=>{p("info","🎯 "+(0,r.__)("Settings saved.","formello"),{type:"snackbar"})})).catch((e=>{p("error","⚠️ "+e.message,{type:"snackbar",explicitDismiss:!0})})),isSaving:h,email:a,hasEdits:u},children:e.children})},x=window.wp.apiFetch;var A=e.n(x);const L=(0,t.createContext)();function P(e){const{token:r,discoveryDocs:o,children:s}=e,[n,a]=(0,t.useState)(),[i,l]=(0,E.useEntityProp)("root","site","popper"),{createNotice:c}=(0,T.useDispatch)(S.store),{saveEditedEntityRecord:d}=(0,T.useDispatch)(E.store),p=()=>{window.gapi.client.init({discoveryDocs:o}).then((()=>{a(!0)}))},h=function(e={}){const{nonce:r,onScriptLoadSuccess:o,onScriptLoadError:s}=e,[n,a]=(0,t.useState)(!1),i=(0,t.useRef)(o);i.current=o;const l=(0,t.useRef)(s);return l.current=s,(0,t.useEffect)((()=>{const e=document.createElement("script");return e.src="https://apis.google.com/js/api.js",e.async=!0,e.defer=!0,e.nonce=r,e.onload=()=>{a(!0),i.current?.()},e.onerror=()=>{a(!1),l.current?.()},document.body.appendChild(e),()=>{document.body.removeChild(e)}}),[r]),n}({onScriptLoadSuccess:()=>{window.gapi.load("client",p)}}),u=()=>{A()({path:"/searchconsole/v1/refresh",method:"POST"}).then((e=>{l({...i,token:e}),d("root","site"),window.gapi.client.setToken(r)})).catch((e=>{c("error","⚠️ "+e.message.error_description,{type:"snackbar",explicitDismiss:!0})}))},g=e=>{401===e.result.error.code||403===e.result.error.code&&"PERMISSION_DENIED"===e.result.error.status?u():c("error","⚠️ "+e.result.error.message,{type:"snackbar",explicitDismiss:!0})},m=(0,t.useMemo)((()=>({ready:n,scriptLoadedSuccessfully:h,handleError:g,refreshToken:u})),[h,n]);return(0,b.jsx)(L.Provider,{value:m,children:s})}const F={animation:{duration:500,easing:"out",startup:!0},tooltip:{isHtml:!0,showTitle:!0},chartArea:{width:"100%"},height:350,hAxis:{gridlines:{count:5,minSpacing:15},minorGridlines:{count:0},showTextEvery:1},vAxis:{textPosition:"none"},vAxes:{},series:{0:{color:"#4285f4",labelInLegend:"Last 28 days"},1:{color:"#4285f4",lineDashStyle:[2,2],labelInLegend:"Previous 28 days"}},legend:{position:"top",alignment:"start"},focusTarget:"category"};function k({url:e}){const{settings:s}=(0,t.useContext)(_),[n,a]=(0,t.useState)(F),[i,l]=(0,t.useState)(!1),[c,d]=(0,t.useState)(),[p,h]=(0,t.useState)("clicks"),u=function(){const e=(0,t.useContext)(L);if(!e)throw new Error("Gapi components must be used within GapiProvider");return e}(s.token),g={siteUrl:s.site,searchType:"web",startDate:(0,D.dateI18n)("Y-m-d",(new Date).setDate((new Date).getDate()-28)),endDate:(0,D.dateI18n)("Y-m-d",(new Date).setDate((new Date).getDate())),dimensions:["date"],dimensionFilterGroups:{},dataState:"all"};(0,t.useEffect)((()=>{u.ready&&(window.gapi.client.setToken(s.token),y())}),[u.ready,s.token]),(0,t.useEffect)((()=>{m()}),[c,p]);const m=(0,t.useCallback)((()=>{if(!c)return;const e=c.current,t=c.previous,r=[];r.push([{type:"number",label:"Day"},{type:"string",role:"tooltip",p:{html:!0}},{label:"Current",type:"number"},{label:"Previous",type:"number"}]);for(const o in t.rows)o>27||r.push([parseInt(o)+1,f(o,e.rows[o].keys[0],v(e.rows[o][p]),t.rows[o].keys[0],v(t.rows[o][p])),{v:e.rows[o][p],f:v(e.rows[o][p])},{v:t.rows[o][p],f:v(t.rows[o][p])}]);l(r)}),[c,p]),C=()=>e?[{filters:[{dimension:"page",expression:e,operator:"EQUALS"}]}]:null,y=()=>{const e=window.gapi.client.newBatch();e.add(window.gapi.client.webmasters.searchanalytics.query({...g,dimensionFilterGroups:C()}),{id:"current"}),e.add(window.gapi.client.webmasters.searchanalytics.query({...g,dimensionFilterGroups:C(),startDate:(0,D.dateI18n)("Y-m-d",(new Date).setDate((new Date).getDate()-56)),endDate:(0,D.dateI18n)("Y-m-d",(new Date).setDate((new Date).getDate()-28))}),{id:"previous"}),e.then((e=>{401===e.result.current.status&&u.handleError(e.result.current),d({current:e.result.current.result,previous:e.result.previous.result})})).catch(u.handleError)},v=e=>"ctr"===p?(100*e).toFixed(2)+"%":"position"===p?e.toFixed(2):e,f=(e,t,o,s,n)=>`<div style="padding: 1rem;"><b>${(0,r.__)("Day")+" "+(parseInt(e)+1)}</b><div style="display: flex; gap: 1rem;"><span>${t}</span><b>${o}</b></div><div style="display: flex; gap: 1rem;"><span>${s}</span><b>${n}</b></div></div>`,E=(e,t)=>{h(e),a({...n,vAxis:{direction:"position"===e?-1:1,format:"ctr"===e?"#,###%":"none"},series:{0:{color:t,labelInLegend:"Last 28 days"},1:{color:t,lineDashStyle:[3,3],labelInLegend:"Previous 28 days"}}})};return i?(0,b.jsxs)("div",{className:"search-console-chart",children:[(0,b.jsxs)(o.ButtonGroup,{children:[(0,b.jsx)(o.Button,{variant:"clicks"===p?"primary":"secondary",size:"small",onClick:()=>E("clicks","#4285f4"),children:(0,r.__)("Clicks","search-console")}),(0,b.jsx)(o.Button,{variant:"impressions"===p?"primary":"secondary",size:"small",onClick:()=>E("impressions","#5e35b1"),children:(0,r.__)("Impressions","search-console")}),(0,b.jsx)(o.Button,{variant:"ctr"===p?"primary":"secondary",size:"small",onClick:()=>E("ctr","#00897b"),children:(0,r.__)("CTR","search-console")}),(0,b.jsx)(o.Button,{variant:"position"===p?"primary":"secondary",size:"small",onClick:()=>E("position","#E8710A"),children:(0,r.__)("Position","search-console")})]}),(0,b.jsx)(w,{chartType:"LineChart",data:i,options:n,chartPackages:["corechart","controls","charteditor"]})]}):(0,b.jsx)(o.Spinner,{})}function R({text:e}){return(0,b.jsxs)("div",{className:"loading-settings",children:[(0,b.jsx)(o.Spinner,{}),(0,b.jsx)("span",{className:"description",children:e})]})}const z={settings:!1,sites:[{label:"Select a site",value:""}],customDate:!1,dimension:"query",searchType:"web",startDate:(0,D.dateI18n)("Y-m-d",(new Date).setDate((new Date).getDate()-29)),endDate:(0,D.dateI18n)("Y-m-d",(new Date).setDate((new Date).getDate()-1)),filters:[]},W={setSites:e=>({type:"SET_SITES",sites:e}),setSettings:e=>({type:"SET_SETTINGS",settings:e}),setSetting:(e,t)=>({type:"SET_SETTING",setting:e,value:t}),setSearchType:e=>({type:"SET_SEARCHTYPE",searchType:e}),setFilter:e=>({type:"SET_FILTER",filter:e}),setDimension:e=>({type:"SET_DIMENSION",dimension:e}),setCustomDate:e=>({type:"SET_CUSTOMDATE",val:e}),setStartDate:e=>({type:"SET_STARTDATE",date:e}),setEndDate:e=>({type:"SET_ENDDATE",date:e}),removeFilter:e=>({type:"REMOVE_FILTER",filter:e}),fetchFromAPI:e=>({type:"FETCH_FROM_API",path:e})},j=(0,T.createReduxStore)("searchconsole",{reducer(e=z,t){switch(t.type){case"SET_SETTINGS":return{...e,settings:t.settings};case"SET_SITES":return{...e,sites:t.sites};case"SET_SETTING":return{...e,settings:{...e.settings,[t.setting]:t.value}};case"SET_SEARCHTYPE":return{...e,searchType:t.searchType};case"SET_DIMENSION":return{...e,dimension:t.dimension};case"SET_CUSTOMDATE":return{...e,customDate:t.val};case"SET_STARTDATE":return{...e,startDate:t.date};case"SET_ENDDATE":return{...e,endDate:t.date};case"SET_FILTER":const r={dimension:t.filter.dimension,expression:t.filter.expression,operator:t.filter.operator},o=e.filters.filter((e=>e.dimension!==t.filter.dimension));return o.push(r),{...e,filters:o};case"REMOVE_FILTER":const s=e.filters.filter((e=>e.dimension!==t.filter.dimension));return{...e,filters:s}}return e},actions:W,selectors:{isReady(e){var t;return null!==(t=e.settings)&&void 0!==t&&t},getSettings(e){const{settings:t}=e;return t},getSites(e){const{sites:t}=e;return t},getSite(e){const{settings:t}=e;return t.site},getQuery(e){const{searchType:t,filters:r,dimension:o,startDate:s,endDate:n}=e;return{dimension:o,startDate:s,endDate:n,searchType:t,filters:r}},getFilterByDimension:(e,t)=>e.filters.length?e.filters.find((e=>e.dimension===t)):{dimension:"",expression:"",operator:""},getSearchType(e){const{searchType:t}=e;return t},getFilters(e){const{filters:t}=e;return t},getCustomDate(e){const{customDate:t}=e;return t}},controls:{FETCH_FROM_API:e=>A()({path:e.path})},resolvers:{*getSettings(){const e=yield W.fetchFromAPI("/searchconsole/v1/settings/");return W.setSettings(e)}}});(0,T.register)(j);const N=()=>{const{settings:e}=(0,t.useContext)(_);return e?e?.site&&e?.credentials?.client_secret&&e?.credentials?.client_id&&e.token.refresh_token?(0,b.jsxs)("div",{children:[(0,b.jsx)(k,{}),(0,b.jsx)(t.RawHTML,{children:(0,r.sprintf)(/* translators: Developer console url. */ /* translators: Developer console url. */
(0,r.__)('More data on <a href="%s">Search Console dashboard</a>.',"formello"),(0,s.addQueryArgs)("admin.php",{page:"search-console"}))})]}):(0,b.jsx)(o.Notice,{status:"warning",isDismissible:!1,children:(0,b.jsx)(t.RawHTML,{children:(0,r.sprintf)(/* translators: Search console settings url. */ /* translators: Search console settings url. */
(0,r.__)('<p>You need to authenticate and set a site on <a href="%s">settings page</a>.</p>',"formello"),(0,s.addQueryArgs)("admin.php",{page:"search-console-settings"}))})}):(0,b.jsx)(R,{text:(0,r.__)("Fetching data…","search-console")})},O=()=>(0,b.jsx)(I,{children:(0,b.jsx)(P,{discoveryDocs:["https://www.googleapis.com/discovery/v1/apis/searchconsole/v1/rest"],children:(0,b.jsx)(N,{})})});window.addEventListener("DOMContentLoaded",(()=>{const e=document.getElementById("search-console-widget");(0,t.createRoot)(e).render((0,b.jsx)(O,{}))}))})();