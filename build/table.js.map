{"version":3,"file":"table.js","mappings":";;;;;;;;;;;;;;AAAO,MAAMA,gBAAgB,GAAGA,CAAA,KAAM;EACrC;EACA,CAAE,YAAY;IACb,MAAMC,EAAE,GAAG,WAAW;IACtB,MAAMC,GAAG,GAAG,wCAAwC;;IAEpD;IACA,MAAMC,OAAO,GAAGC,QAAQ,CAACC,oBAAoB,CAAE,QAAS,CAAC,CAAE,CAAC,CAAE;;IAE9D;IACA,IAAKD,QAAQ,CAACE,cAAc,CAAEL,EAAG,CAAC,EAAG;MACpC;IACD;IACA,MAAMM,EAAE,GAAGH,QAAQ,CAACI,aAAa,CAAE,QAAS,CAAC;IAC7CD,EAAE,CAACN,EAAE,GAAGA,EAAE;IACVM,EAAE,CAACL,GAAG,GAAGA,GAAG;IACZK,EAAE,CAACE,MAAM,GAAGC,MAAM,CAACC,kBAAkB;IACrCR,OAAO,CAACS,UAAU,CAACC,YAAY,CAAEN,EAAE,EAAEJ,OAAQ,CAAC;EAC/C,CAAC,EAAG,CAAC;AACN,CAAC;;;;;;;;;;ACnBD;;;;;;;;;;ACAA;;;;;;UCAA;UACA;;UAEA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;;UAEA;UACA;;UAEA;UACA;UACA;;;;;WCtBA;WACA;WACA;WACA;WACA;WACA,iCAAiC,WAAW;WAC5C;WACA;;;;;WCPA;WACA;WACA;WACA;WACA,yCAAyC,wCAAwC;WACjF;WACA;WACA;;;;;WCPA;;;;;WCAA;WACA;WACA;WACA,uDAAuD,iBAAiB;WACxE;WACA,gDAAgD,aAAa;WAC7D;;;;;;;;;;;;;;;;ACN8C;AACH;AACC;AAE5C,IAAIa,KAAK,GAAG,EAAE;AACd,MAAMC,UAAU,GAAG;EAClBC,OAAO,EAAE,EAAE;EACXC,UAAU,EAAE,KAAK;EACjBC,SAAS,EAAEN,yDAAQ,CAClB,OAAO,EACP,IAAIO,IAAI,CAAC,CAAC,CAACC,OAAO,CAAE,IAAID,IAAI,CAAC,CAAC,CAACE,OAAO,CAAC,CAAC,GAAG,EAAG,CAC/C,CAAC;EACDC,OAAO,EAAEV,yDAAQ,CAChB,OAAO,EACP,IAAIO,IAAI,CAAC,CAAC,CAACC,OAAO,CAAE,IAAID,IAAI,CAAC,CAAC,CAACE,OAAO,CAAC,CAAC,GAAG,CAAE,CAC9C,CAAC;EACDE,UAAU,EAAE,CAAE,MAAM,CAAE;EACtBC,qBAAqB,EAAE,CAAC,CAAC;EACzB;EACAC,QAAQ,EAAE,CAAC;EACXC,QAAQ,EAAE;AACX,CAAC;AAED,MAAMC,OAAO,GAAG,EAAE;AAElBnB,MAAM,CAACoB,MAAM,CAAE1B,QAAS,CAAC,CAAC2B,KAAK,CAAE,YAAY;EAC5CrB,MAAM,CAACoB,MAAM,CAAE,UAAW,CAAC,CAACE,IAAI,CAAE,CAAEC,KAAK,EAAEC,EAAE,KAAM;IAClDL,OAAO,CAACM,IAAI,CAAEzB,MAAM,CAACoB,MAAM,CAAEI,EAAG,CAAC,CAACE,IAAI,CAAE,KAAM,CAAE,CAAC;EAClD,CAAE,CAAC;AACJ,CAAE,CAAC;AAEH,SAASC,YAAYA,CAAA,EAAG;EACvBtB,2DAAQ,CAAE;IACTuB,IAAI,EAAE,2BAA2B;IACjCC,MAAM,EAAE;EACT,CAAE,CAAC,CAACC,IAAI,CAAIC,MAAM,IAAM;IACvB/B,MAAM,CAACgC,IAAI,CAACC,MAAM,CAACC,QAAQ,CAAEH,MAAO,CAAC;IACrCI,SAAS,CAAC,CAAC;EACZ,CAAE,CAAC;AACJ;;AAEA;AACAnC,MAAM,CAACC,kBAAkB,GAAG,MAAM;EACjC;EACAI,2DAAQ,CAAE;IAAEuB,IAAI,EAAE;EAAmB,CAAE,CAAC,CAACE,IAAI,CAAIC,MAAM,IAAM;IAC5DzB,KAAK,GAAGyB,MAAM,CAACK,cAAc,CAAC9B,KAAK;IACnCC,UAAU,CAACC,OAAO,GAAGuB,MAAM,CAACK,cAAc,CAACC,IAAI;IAC/CrC,MAAM,CAACgC,IAAI,CAACM,IAAI,CAAE,QAAQ,EAAEC,KAAM,CAAC;EACpC,CAAE,CAAC;AACJ,CAAC;AAED,SAASA,KAAKA,CAAA,EAAG;EAChBvC,MAAM,CAACgC,IAAI,CAACC,MAAM,CAACK,IAAI,CAAE,eAAe,EAAE,IAAK,CAAC,CAACR,IAAI,CAAE,MAAM;IAC5D9B,MAAM,CAACgC,IAAI,CAACC,MAAM,CAACC,QAAQ,CAAE5B,KAAM,CAAC;IACpCkC,KAAK,CAAC,CAAC;EACR,CAAE,CAAC;AACJ;AAEA,SAASA,KAAKA,CAAA,EAAG;EAChBxC,MAAM,CAACgC,IAAI,CAACC,MAAM,CAACQ,UAAU,CAACC,QAAQ,CACpCC,IAAI,CAAE;IAAEnC,OAAO,EAAED,UAAU,CAACC;EAAQ,CAAE,CAAC,CACvCsB,IAAI,CAAE,YAAY;IAClBK,SAAS,CAAC,CAAC;EACZ,CAAE,CAAC,CACFS,KAAK,CAAIC,KAAK,IAAM;IACpB,IAAK,GAAG,KAAKA,KAAK,CAACC,MAAM,EAAG;MAC3BnB,YAAY,CAAC,CAAC;IACf;EACD,CAAE,CAAC;AACL;AAEA,SAASQ,SAASA,CAAA,EAAG;EACpB,MAAMY,KAAK,GAAG/C,MAAM,CAACgC,IAAI,CAACC,MAAM,CAACe,QAAQ,CAAC,CAAC;EAC3C,MAAMC,SAAS,GAAGjD,MAAM,CAACgC,IAAI,CAACC,MAAM,CAACe,QAAQ,CAAC,CAAC;EAE/C,KAAM,MAAME,GAAG,IAAI/B,OAAO,EAAG;IAC5B,MAAMgC,GAAG,GAAG,CACX;MACCC,OAAO,EAAE,CACR;QACCC,SAAS,EAAE,MAAM;QACjBC,QAAQ,EAAE,QAAQ;QAClBC,UAAU,EAAEL;MACb,CAAC;IAEH,CAAC,CACD;IACDH,KAAK,CAACS,GAAG,CACRxD,MAAM,CAACgC,IAAI,CAACC,MAAM,CAACQ,UAAU,CAACgB,eAAe,CAACC,KAAK,CAAE;MACpD,GAAGnD,UAAU;MACbS,qBAAqB,EAAEmC;IACxB,CAAE,CAAC,EACH;MACC5D,EAAE,EAAE2D;IACL,CACD,CAAC;IACDD,SAAS,CAACO,GAAG,CACZxD,MAAM,CAACgC,IAAI,CAACC,MAAM,CAACQ,UAAU,CAACgB,eAAe,CAACC,KAAK,CAAE;MACpD,GAAGnD,UAAU;MACbS,qBAAqB,EAAEmC,GAAG;MAC1BzC,SAAS,EAAEN,yDAAQ,CAClB,OAAO,EACP,IAAIO,IAAI,CAAC,CAAC,CAACC,OAAO,CAAE,IAAID,IAAI,CAAC,CAAC,CAACE,OAAO,CAAC,CAAC,GAAG,EAAG,CAC/C,CAAC;MACDC,OAAO,EAAEV,yDAAQ,CAChB,OAAO,EACP,IAAIO,IAAI,CAAC,CAAC,CAACC,OAAO,CAAE,IAAID,IAAI,CAAC,CAAC,CAACE,OAAO,CAAC,CAAC,GAAG,EAAG,CAC/C;IACD,CAAE,CAAC,EACH;MACCtB,EAAE,EAAE2D;IACL,CACD,CAAC;EACF;EAEAS,OAAO,CAACC,GAAG,CAAE,CAAEb,KAAK,EAAEE,SAAS,CAAG,CAAC,CAACnB,IAAI,CAAI+B,MAAM,IAAM;IACvD,MAAMC,OAAO,GAAGD,MAAM,CAAE,CAAC,CAAE,CAAC9B,MAAM;IAClC,MAAMgC,QAAQ,GAAGF,MAAM,CAAE,CAAC,CAAE,CAAC9B,MAAM;IAEnC,MAAMA,MAAM,GAAG,CAAC,CAAC;IAEjB,KAAM,MAAMmB,GAAG,IAAIY,OAAO,EAAG;MAC5B,IAAK,CAAEC,QAAQ,CAAEb,GAAG,CAAE,CAACnB,MAAM,EAAEiC,IAAI,GAAI,CAAC,CAAE,EAAG;QAC5C;MACD;MACAjC,MAAM,CAAEmB,GAAG,CAAE,GAAG;QACfY,OAAO,EAAEA,OAAO,CAAEZ,GAAG,CAAE,CAACnB,MAAM,CAACiC,IAAI,CAAE,CAAC,CAAE;QACxCD,QAAQ,EAAEA,QAAQ,CAAEb,GAAG,CAAE,CAACnB,MAAM,CAACiC,IAAI,CAAE,CAAC;MACzC,CAAC;MAED,IAAK7C,OAAO,CAAC8C,OAAO,CAAEf,GAAI,CAAC,GAAG,CAAC,CAAC,IAAInB,MAAM,CAAEmB,GAAG,CAAE,EAAG;QACnDlD,MAAM,CACJoB,MAAM,CAAE,iBAAiB,GAAG8B,GAAG,GAAG,IAAK,CAAC,CACxCgB,IAAI,CAAEC,gBAAgB,CAAEpC,MAAM,CAAEmB,GAAG,CAAG,CAAE,CAAC;MAC5C;IACD;EACD,CAAE,CAAC;AACJ;AAEA,MAAMiB,gBAAgB,GAAGA,CAAE;EAAEL,OAAO;EAAEC;AAAS,CAAC,KAAO;AACvD,kBAAmBD,OAAO,CAACM,MAAM,IAAI,KAAO,KAC1CL,QAAQ,CAACK,MAAM,IAAI,KACnB;AACF,oBAAqBC,IAAI,CAACC,KAAK,CAAER,OAAO,CAACS,QAAQ,GAAG,GAAI,CAAC,GAAG,GAAG,IAAI,KAAO,KACxEF,IAAI,CAACC,KAAK,CAAEP,QAAQ,CAACQ,QAAQ,GAAG,GAAI,CAAC,GAAG,GAAG,IAAI,KAC/C;AACF,eAAgB,CAAET,OAAO,CAACU,GAAG,GAAG,GAAG,EAAGC,OAAO,CAAE,CAAE,CAAC,GAAG,GAAG,IAAI,CAAO,KACjE,CAAEV,QAAQ,CAACS,GAAG,GAAG,GAAG,EAAGC,OAAO,CAAE,CAAE,CAAC,GAAG,GAAG,IAAI,CAC7C;AACF,uBAAwBX,OAAO,CAACY,WAAW,IAAI,KAAO,KACpDX,QAAQ,CAACW,WAAW,IAAI,KACxB,SAAQ;AACVpF,2DAAgB,CAAC,CAAC,C","sources":["webpack://search-console/./src/table/loadGapi.js","webpack://search-console/external window [\"wp\",\"apiFetch\"]","webpack://search-console/external window [\"wp\",\"date\"]","webpack://search-console/webpack/bootstrap","webpack://search-console/webpack/runtime/compat get default export","webpack://search-console/webpack/runtime/define property getters","webpack://search-console/webpack/runtime/hasOwnProperty shorthand","webpack://search-console/webpack/runtime/make namespace object","webpack://search-console/./src/table/index.js"],"sourcesContent":["export const loadGoogleScript = () => {\n\t// Loads the Google JavaScript Library\n\t( function () {\n\t\tconst id = 'google-js';\n\t\tconst src = 'https://apis.google.com/js/platform.js';\n\n\t\t// We have at least one script\n\t\tconst firstJs = document.getElementsByTagName( 'script' )[ 0 ];\n\n\t\t// Prevent script from loading twice\n\t\tif ( document.getElementById( id ) ) {\n\t\t\treturn;\n\t\t}\n\t\tconst js = document.createElement( 'script' );\n\t\tjs.id = id;\n\t\tjs.src = src;\n\t\tjs.onload = window.onGoogleScriptLoad;\n\t\tfirstJs.parentNode.insertBefore( js, firstJs );\n\t} )();\n};\n","module.exports = window[\"wp\"][\"apiFetch\"];","module.exports = window[\"wp\"][\"date\"];","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import { loadGoogleScript } from './loadGapi';\nimport { dateI18n } from '@wordpress/date';\nimport apiFetch from '@wordpress/api-fetch';\n\nlet token = '';\nconst chartQuery = {\n\tsiteUrl: '',\n\tsearchType: 'web',\n\tstartDate: dateI18n(\n\t\t'Y-m-d',\n\t\tnew Date().setDate( new Date().getDate() - 29 )\n\t),\n\tendDate: dateI18n(\n\t\t'Y-m-d',\n\t\tnew Date().setDate( new Date().getDate() - 1 )\n\t),\n\tdimensions: [ 'page' ],\n\tdimensionFilterGroups: {},\n\t//aggregationType: 'byPage',\n\tstartRow: 0,\n\trowLimit: 1,\n};\n\nconst allUrls = [];\n\nwindow.jQuery( document ).ready( function () {\n\twindow.jQuery( '.gsc-url' ).each( ( index, el ) => {\n\t\tallUrls.push( window.jQuery( el ).data( 'url' ) );\n\t} );\n} );\n\nfunction refreshToken() {\n\tapiFetch( {\n\t\tpath: '/searchconsole/v1/refresh',\n\t\tmethod: 'POST',\n\t} ).then( ( result ) => {\n\t\twindow.gapi.client.setToken( result );\n\t\tgetReport();\n\t} );\n}\n\n// callback on gapi loaded\nwindow.onGoogleScriptLoad = () => {\n\t// get settings\n\tapiFetch( { path: '/wp/v2/settings/' } ).then( ( result ) => {\n\t\ttoken = result.search_console.token;\n\t\tchartQuery.siteUrl = result.search_console.site;\n\t\twindow.gapi.load( 'client', start );\n\t} );\n};\n\nfunction start() {\n\twindow.gapi.client.load( 'searchconsole', 'v1' ).then( () => {\n\t\twindow.gapi.client.setToken( token );\n\t\tcheck();\n\t} );\n}\n\nfunction check() {\n\twindow.gapi.client.webmasters.sitemaps\n\t\t.list( { siteUrl: chartQuery.siteUrl } )\n\t\t.then( function () {\n\t\t\tgetReport();\n\t\t} )\n\t\t.catch( ( error ) => {\n\t\t\tif ( 401 === error.status ) {\n\t\t\t\trefreshToken();\n\t\t\t}\n\t\t} );\n}\n\nfunction getReport() {\n\tconst batch = window.gapi.client.newBatch();\n\tconst batchPrev = window.gapi.client.newBatch();\n\n\tfor ( const url of allUrls ) {\n\t\tconst req = [\n\t\t\t{\n\t\t\t\tfilters: [\n\t\t\t\t\t{\n\t\t\t\t\t\tdimension: 'page',\n\t\t\t\t\t\toperator: 'EQUALS',\n\t\t\t\t\t\texpression: url,\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t},\n\t\t];\n\t\tbatch.add(\n\t\t\twindow.gapi.client.webmasters.searchanalytics.query( {\n\t\t\t\t...chartQuery,\n\t\t\t\tdimensionFilterGroups: req,\n\t\t\t} ),\n\t\t\t{\n\t\t\t\tid: url,\n\t\t\t}\n\t\t);\n\t\tbatchPrev.add(\n\t\t\twindow.gapi.client.webmasters.searchanalytics.query( {\n\t\t\t\t...chartQuery,\n\t\t\t\tdimensionFilterGroups: req,\n\t\t\t\tstartDate: dateI18n(\n\t\t\t\t\t'Y-m-d',\n\t\t\t\t\tnew Date().setDate( new Date().getDate() - 57 )\n\t\t\t\t),\n\t\t\t\tendDate: dateI18n(\n\t\t\t\t\t'Y-m-d',\n\t\t\t\t\tnew Date().setDate( new Date().getDate() - 30 )\n\t\t\t\t),\n\t\t\t} ),\n\t\t\t{\n\t\t\t\tid: url,\n\t\t\t}\n\t\t);\n\t}\n\n\tPromise.all( [ batch, batchPrev ] ).then( ( values ) => {\n\t\tconst current = values[ 0 ].result;\n\t\tconst previous = values[ 1 ].result;\n\n\t\tconst result = {};\n\n\t\tfor ( const url in current ) {\n\t\t\tif ( ! previous[ url ].result?.rows?.[ 0 ] ) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tresult[ url ] = {\n\t\t\t\tcurrent: current[ url ].result.rows[ 0 ],\n\t\t\t\tprevious: previous[ url ].result.rows[ 0 ],\n\t\t\t};\n\n\t\t\tif ( allUrls.indexOf( url ) > -1 && result[ url ] ) {\n\t\t\t\twindow\n\t\t\t\t\t.jQuery( 'span[data-url=\"' + url + '\"]' )\n\t\t\t\t\t.html( createReportHtml( result[ url ] ) );\n\t\t\t}\n\t\t}\n\t} );\n}\n\nconst createReportHtml = ( { current, previous } ) => `\n\t<b>Clicks:</b> ${ current.clicks || 'n/a' } (${\n\t\tprevious.clicks || 'n/a'\n\t})<br />\n\t<b>Position:</b> ${ Math.round( current.position * 100 ) / 100 || 'n/a' } (${\n\t\tMath.round( previous.position * 100 ) / 100 || 'n/a'\n\t})<br />\n\t<b>CTR:</b> ${ ( current.ctr * 100 ).toFixed( 2 ) + '%' || 'n/a' } (${\n\t\t( previous.ctr * 100 ).toFixed( 2 ) + '%' || 'n/a'\n\t})<br />\n\t<b>Impressions:</b> ${ current.impressions || 'n/a' } (${\n\t\tprevious.impressions || 'n/a'\n\t})<br />`;\nloadGoogleScript();\n"],"names":["loadGoogleScript","id","src","firstJs","document","getElementsByTagName","getElementById","js","createElement","onload","window","onGoogleScriptLoad","parentNode","insertBefore","dateI18n","apiFetch","token","chartQuery","siteUrl","searchType","startDate","Date","setDate","getDate","endDate","dimensions","dimensionFilterGroups","startRow","rowLimit","allUrls","jQuery","ready","each","index","el","push","data","refreshToken","path","method","then","result","gapi","client","setToken","getReport","search_console","site","load","start","check","webmasters","sitemaps","list","catch","error","status","batch","newBatch","batchPrev","url","req","filters","dimension","operator","expression","add","searchanalytics","query","Promise","all","values","current","previous","rows","indexOf","html","createReportHtml","clicks","Math","round","position","ctr","toFixed","impressions"],"sourceRoot":""}