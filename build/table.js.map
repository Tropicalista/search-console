{"version":3,"file":"table.js","mappings":"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","sources":["webpack://search-console/./src/table/loadGapi.js","webpack://search-console/external window [\"wp\",\"apiFetch\"]","webpack://search-console/external window [\"wp\",\"date\"]","webpack://search-console/webpack/bootstrap","webpack://search-console/webpack/runtime/compat get default export","webpack://search-console/webpack/runtime/define property getters","webpack://search-console/webpack/runtime/hasOwnProperty shorthand","webpack://search-console/webpack/runtime/make namespace object","webpack://search-console/./src/table/index.js"],"sourcesContent":["export const loadGoogleScript = () => {\n\t// Loads the Google JavaScript Library\n\t( function () {\n\t\tconst id = 'google-js';\n\t\tconst src = 'https://apis.google.com/js/platform.js';\n\n\t\t// We have at least one script\n\t\tconst firstJs = document.getElementsByTagName( 'script' )[ 0 ];\n\n\t\t// Prevent script from loading twice\n\t\tif ( document.getElementById( id ) ) {\n\t\t\treturn;\n\t\t}\n\t\tconst js = document.createElement( 'script' );\n\t\tjs.id = id;\n\t\tjs.src = src;\n\t\tjs.onload = window.onGoogleScriptLoad;\n\t\tfirstJs.parentNode.insertBefore( js, firstJs );\n\t} )();\n};\n","module.exports = window[\"wp\"][\"apiFetch\"];","module.exports = window[\"wp\"][\"date\"];","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import { loadGoogleScript } from './loadGapi';\nimport { dateI18n } from '@wordpress/date';\nimport apiFetch from '@wordpress/api-fetch';\n\nlet token = '';\nconst chartQuery = {\n\tsiteUrl: '',\n\trowLimit: null,\n\tsearchType: 'web',\n\tstartDate: dateI18n(\n\t\t'Y-m-d',\n\t\tnew Date().setDate( new Date().getDate() - 29 )\n\t),\n\tendDate: dateI18n(\n\t\t'Y-m-d',\n\t\tnew Date().setDate( new Date().getDate() - 1 )\n\t),\n\tdimensions: [ 'page' ],\n};\n\nconst allUrls = [];\n\nwindow.jQuery( document ).ready( function () {\n\twindow.jQuery( '.gsc-url' ).each( ( index ) => {\n\t\tallUrls.push( window.jQuery( this ).data( 'url' ) );\n\t} );\n} );\n\nfunction refreshToken() {\n\tapiFetch( {\n\t\tpath: '/searchconsole/v1/refresh',\n\t\tmethod: 'POST',\n\t} ).then( ( result ) => {\n\t\twindow.gapi.client.setToken( result );\n\t} );\n}\n\n// callback on gapi loaded\nwindow.onGoogleScriptLoad = () => {\n\t// get settings\n\tapiFetch( { path: '/searchconsole/v1/settings/' } ).then( ( result ) => {\n\t\ttoken = result.token;\n\t\tchartQuery.siteUrl = result.site;\n\t\twindow.gapi.load( 'client', start );\n\t} );\n};\n\nfunction start() {\n\twindow.gapi.client.load( 'searchconsole', 'v1' ).then( () => {\n\t\twindow.gapi.client.setToken( token );\n\t\tgetReport();\n\t} );\n}\n\nfunction getReport() {\n\twindow.gapi.client.webmasters.searchanalytics\n\t\t.query( chartQuery )\n\t\t.then( function ( response ) {\n\t\t\tresponse.result.rows.forEach( function ( x ) {\n\t\t\t\tif ( allUrls.indexOf( x.keys[ 0 ] ) > -1 ) {\n\t\t\t\t\twindow\n\t\t\t\t\t\t.jQuery( 'span[data-url=\"' + x.keys[ 0 ] + '\"]' )\n\t\t\t\t\t\t.html( createReportHtml( x ) );\n\t\t\t\t}\n\t\t\t} );\n\t\t} )\n\t\t.catch( ( error ) => {\n\t\t\tif ( 401 === error.status ) {\n\t\t\t\trefreshToken();\n\t\t\t}\n\t\t} );\n}\n\nconst createReportHtml = ( { clicks, position, impressions, ctr } ) => `\n\t<b>Clicks:</b> ${ clicks }<br />\n\t<b>Position:</b> ${ Math.round( position * 100 ) / 100 }<br />\n\t<b>CTR:</b> ${ Math.round( ctr * 10000 ) / 100 }%<br />\n\t<b>Impressions:</b> ${ impressions }<br />`;\n\nloadGoogleScript();\n"],"names":["loadGoogleScript","id","src","firstJs","document","getElementsByTagName","getElementById","js","createElement","onload","window","onGoogleScriptLoad","parentNode","insertBefore","dateI18n","apiFetch","token","chartQuery","siteUrl","rowLimit","searchType","startDate","Date","setDate","getDate","endDate","dimensions","allUrls","jQuery","ready","each","index","push","data","refreshToken","path","method","then","result","gapi","client","setToken","site","load","start","getReport","webmasters","searchanalytics","query","response","rows","forEach","x","indexOf","keys","html","createReportHtml","catch","error","status","clicks","position","impressions","ctr","Math","round"],"sourceRoot":""}